{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nexport let UserDashboardComponent = class UserDashboardComponent {\n  constructor(policySvc, claimSvc, purchaseRequestSvc, auth) {\n    this.policySvc = policySvc;\n    this.claimSvc = claimSvc;\n    this.purchaseRequestSvc = purchaseRequestSvc;\n    this.auth = auth;\n    this.policies = [];\n    this.claims = [];\n    this.purchaseRequests = [];\n    this.userId = 0;\n    this.newClaim = {\n      policy_number: \"\",\n      description: \"\"\n    };\n    this.file = null;\n  }\n  ngOnInit() {\n    this.userId = this.auth.userId;\n    this.load();\n  }\n  load() {\n    this.policySvc.byUser(this.userId).subscribe(p => this.policies = p || []);\n    this.claimSvc.byUser(this.userId).subscribe(c => this.claims = c || []);\n    this.purchaseRequestSvc.byUser(this.userId).subscribe(pr => this.purchaseRequests = pr || []);\n  }\n  getPendingClaims() {\n    return this.claims.filter(claim => claim.status === \"Pending\").length;\n  }\n  onFile(e) {\n    this.file = e.target.files && e.target.files[0] ? e.target.files[0] : null;\n  }\n  submit() {\n    const fd = new FormData();\n    fd.append(\"policy_number\", this.newClaim.policy_number);\n    fd.append(\"description\", this.newClaim.description);\n    if (this.file) fd.append(\"file\", this.file);\n    this.claimSvc.createForm(fd).subscribe({\n      next: () => {\n        this.newClaim = {\n          policy_number: \"\",\n          description: \"\"\n        };\n        this.file = null;\n        this.load();\n      },\n      error: err => alert(err?.error?.error || \"Failed to submit claim\")\n    });\n  }\n  attachmentUrl(c, dl = false) {\n    return this.claimSvc.attachmentUrl(c.attachment, dl);\n  }\n  remove(id) {\n    if (!confirm(\"Delete claim?\")) return;\n    this.claimSvc.remove(id).subscribe(() => this.load());\n  }\n};\nUserDashboardComponent = __decorate([Component({\n  selector: \"app-user-dashboard\",\n  templateUrl: \"./user-dashboard.component.html\"\n})], UserDashboardComponent);","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}