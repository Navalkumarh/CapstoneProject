{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/policy.service\";\nimport * as i2 from \"../../services/claim.service\";\nimport * as i3 from \"../../services/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction UserDashboardComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1, \"No policies assigned to your User ID yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UserDashboardComponent_li_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 21)(1, \"div\", 22);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 20);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const p_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", p_r5.policy_number, \" \\u2014 \", p_r5.type, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\"Start: \", p_r5.start_date, \" | End: \", p_r5.end_date, \" | Premium: \", p_r5.premium, \"\");\n  }\n}\nfunction UserDashboardComponent_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const p_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", p_r6.policy_number);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\"\", p_r6.policy_number, \" \\u2014 \", p_r6.type, \"\");\n  }\n}\nfunction UserDashboardComponent_div_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1, \"No claims yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction UserDashboardComponent_div_44_tr_18_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r8 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Remarks: \", c_r8.remarks, \"\");\n  }\n}\nfunction UserDashboardComponent_div_44_tr_18_a_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 34);\n    i0.ɵɵtext(1, \"Download\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const c_r8 = i0.ɵɵnextContext().$implicit;\n    const ctx_r10 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"href\", ctx_r10.attachmentUrl(c_r8, true), i0.ɵɵsanitizeUrl);\n  }\n}\nfunction UserDashboardComponent_div_44_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\")(11, \"span\", 28);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(13, UserDashboardComponent_div_44_tr_18_div_13_Template, 2, 1, \"div\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtemplate(15, UserDashboardComponent_div_44_tr_18_a_15_Template, 2, 1, \"a\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"td\", 31)(17, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function UserDashboardComponent_div_44_tr_18_Template_button_click_17_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const c_r8 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.remove(c_r8.claim_id));\n    });\n    i0.ɵɵtext(18, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const c_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r8.claim_id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r8.policy_number);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r8.description);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(9, 13, c_r8.created_at, \"mediumDate\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassProp(\"bg-secondary\", c_r8.status === \"Pending\")(\"bg-success\", c_r8.status === \"Approved\")(\"bg-danger\", c_r8.status === \"Rejected\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(c_r8.status);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", c_r8.remarks);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", c_r8.attachment);\n  }\n}\nfunction UserDashboardComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"table\", 25)(2, \"thead\", 26)(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"#\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"Policy\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Date of Claim\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Attachment\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(16, \"th\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"tbody\");\n    i0.ɵɵtemplate(18, UserDashboardComponent_div_44_tr_18_Template, 19, 16, \"tr\", 27);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(18);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r4.claims);\n  }\n}\nexport let UserDashboardComponent = /*#__PURE__*/(() => {\n  class UserDashboardComponent {\n    constructor(policySvc, claimSvc, auth) {\n      this.policySvc = policySvc;\n      this.claimSvc = claimSvc;\n      this.auth = auth;\n      this.policies = [];\n      this.claims = [];\n      this.userId = 0;\n      this.newClaim = {\n        policy_number: '',\n        description: ''\n      };\n      this.file = null;\n    }\n    ngOnInit() {\n      this.userId = this.auth.userId;\n      this.load();\n    }\n    load() {\n      this.policySvc.byUser(this.userId).subscribe(p => this.policies = p || []);\n      this.claimSvc.byUser(this.userId).subscribe(c => this.claims = c || []);\n    }\n    onFile(e) {\n      this.file = e.target.files && e.target.files[0] ? e.target.files[0] : null;\n    }\n    submit() {\n      const fd = new FormData();\n      fd.append('policy_number', this.newClaim.policy_number);\n      fd.append('description', this.newClaim.description);\n      if (this.file) fd.append('file', this.file);\n      this.claimSvc.createForm(fd).subscribe({\n        next: () => {\n          this.newClaim = {\n            policy_number: '',\n            description: ''\n          };\n          this.file = null;\n          this.load();\n        },\n        error: err => alert(err?.error?.error || 'Failed to submit claim')\n      });\n    }\n    attachmentUrl(c, dl = false) {\n      return this.claimSvc.attachmentUrl(c.attachment, dl);\n    }\n    remove(id) {\n      if (!confirm('Delete claim?')) return;\n      this.claimSvc.remove(id).subscribe(() => this.load());\n    }\n    static {\n      this.ɵfac = function UserDashboardComponent_Factory(t) {\n        return new (t || UserDashboardComponent)(i0.ɵɵdirectiveInject(i1.PolicyService), i0.ɵɵdirectiveInject(i2.ClaimService), i0.ɵɵdirectiveInject(i3.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: UserDashboardComponent,\n        selectors: [[\"app-user-dashboard\"]],\n        decls: 45,\n        vars: 9,\n        consts: [[1, \"container-xxl\"], [1, \"row\", \"g-4\"], [1, \"col-12\"], [1, \"alert\", \"alert-info\"], [1, \"col-lg-6\"], [1, \"card\", \"p-3\"], [\"class\", \"text-muted small\", 4, \"ngIf\"], [1, \"list-group\"], [\"class\", \"list-group-item\", 4, \"ngFor\", \"ngForOf\"], [1, \"row\", \"g-2\"], [1, \"form-label\"], [\"required\", \"\", 1, \"form-select\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"rows\", \"3\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"file\", \"accept\", \"image/*,application/pdf\", \"required\", \"\", 1, \"form-control\", 3, \"change\"], [1, \"form-text\"], [1, \"col-12\", \"d-flex\", \"justify-content-end\"], [1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [\"class\", \"table-responsive-md sticky-head\", 4, \"ngIf\"], [1, \"text-muted\", \"small\"], [1, \"list-group-item\"], [1, \"fw-semibold\"], [3, \"value\"], [1, \"table-responsive-md\", \"sticky-head\"], [1, \"table\", \"table-striped\", \"align-middle\"], [1, \"table-light\"], [4, \"ngFor\", \"ngForOf\"], [1, \"badge\"], [\"class\", \"text-danger small mt-1\", 4, \"ngIf\"], [\"class\", \"link-like\", \"target\", \"_blank\", 3, \"href\", 4, \"ngIf\"], [1, \"text-end\"], [1, \"btn\", \"btn-sm\", \"btn-outline-danger\", 3, \"click\"], [1, \"text-danger\", \"small\", \"mt-1\"], [\"target\", \"_blank\", 1, \"link-like\", 3, \"href\"]],\n        template: function UserDashboardComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3);\n            i0.ɵɵtext(4, \"Logged in as User ID: \");\n            i0.ɵɵelementStart(5, \"strong\");\n            i0.ɵɵtext(6);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(7, \"div\", 4)(8, \"div\", 5)(9, \"h5\");\n            i0.ɵɵtext(10, \"Available Policies (for you)\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(11, UserDashboardComponent_div_11_Template, 2, 0, \"div\", 6);\n            i0.ɵɵelementStart(12, \"ul\", 7);\n            i0.ɵɵtemplate(13, UserDashboardComponent_li_13_Template, 5, 5, \"li\", 8);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(14, \"div\", 4)(15, \"div\", 5)(16, \"h5\");\n            i0.ɵɵtext(17, \"File a Claim\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 9)(19, \"div\", 2)(20, \"label\", 10);\n            i0.ɵɵtext(21, \"Policy\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(22, \"select\", 11);\n            i0.ɵɵlistener(\"ngModelChange\", function UserDashboardComponent_Template_select_ngModelChange_22_listener($event) {\n              return ctx.newClaim.policy_number = $event;\n            });\n            i0.ɵɵelementStart(23, \"option\", 12);\n            i0.ɵɵtext(24, \"-- Select --\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(25, UserDashboardComponent_option_25_Template, 2, 3, \"option\", 13);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(26, \"div\", 2)(27, \"label\", 10);\n            i0.ɵɵtext(28, \"Description\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(29, \"textarea\", 14);\n            i0.ɵɵlistener(\"ngModelChange\", function UserDashboardComponent_Template_textarea_ngModelChange_29_listener($event) {\n              return ctx.newClaim.description = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(30, \"div\", 2)(31, \"label\", 10);\n            i0.ɵɵtext(32, \"Attachment\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(33, \"input\", 15);\n            i0.ɵɵlistener(\"change\", function UserDashboardComponent_Template_input_change_33_listener($event) {\n              return ctx.onFile($event);\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(34, \"div\", 16);\n            i0.ɵɵtext(35, \"Upload an image or PDF. This is required.\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(36, \"div\", 17)(37, \"button\", 18);\n            i0.ɵɵlistener(\"click\", function UserDashboardComponent_Template_button_click_37_listener() {\n              return ctx.submit();\n            });\n            i0.ɵɵtext(38, \"Submit Claim\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(39, \"div\", 2)(40, \"div\", 5)(41, \"h5\");\n            i0.ɵɵtext(42, \"My Claims\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(43, UserDashboardComponent_div_43_Template, 2, 0, \"div\", 6);\n            i0.ɵɵtemplate(44, UserDashboardComponent_div_44_Template, 19, 1, \"div\", 19);\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate(ctx.userId);\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", !ctx.policies.length);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngForOf\", ctx.policies);\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"ngModel\", ctx.newClaim.policy_number);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngForOf\", ctx.policies);\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.newClaim.description);\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"disabled\", !ctx.newClaim.policy_number || !ctx.newClaim.description || !ctx.file);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngIf\", !ctx.claims.length);\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"ngIf\", ctx.claims.length);\n          }\n        },\n        dependencies: [i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.RequiredValidator, i5.NgModel, i4.DatePipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return UserDashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}